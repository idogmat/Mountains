(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{414:function(t,a,e){"use strict";e.d(a,"a",(function(){return o}));var r=e(325),o=function(t){var a=r.a.defaults.baseURL;return"".concat(a,"/").concat(t)}},425:function(t,a,e){},442:function(t,a,e){"use strict";var r=e(425);e.n(r).a},459:function(t,a,e){"use strict";e.r(a);var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"addWorks__content"},[e("div",{staticClass:"addWorks__content-caption-wrap"},["add"==t.mode?e("h2",{staticClass:"addWorks__content-caption"},[t._v("Добавление работы")]):"edit"==t.mode?e("h2",{staticClass:"addWorks__content-caption"},[t._v("Редактирование работы")]):t._e(),e("div",{staticClass:"addWorks__form"},[e("div",{staticClass:"addWorks__file",class:{imaged:t.hasImage,validErrorTextarea:t.validation.hasError("workData.photo")},style:{"background-image":"url("+this.photoURl+")"}},[e("div",{staticClass:"addWorks__file-upload"},[e("label",{staticClass:"addWorks__load-text",attrs:{for:"photoFile"}},[e("p",[t._v("Перетащите или загрузите для загрузки изображения")]),e("vue-dropzone",{staticClass:"dropzone",attrs:{id:"drop1",options:t.dropOptions}}),e("input",{staticClass:"addWorks__file-input",attrs:{type:"file",id:"photoFile",accept:"image/*"},on:{change:t.loadPhoto}}),e("button",{staticClass:"btn-save btn"},[t._v("Загрузить")])],1)])]),e("div",{staticClass:"addWorks__info"},[e("div",{staticClass:"addWorks__label-wrap"},[e("label",{staticClass:"addWorks__label",attrs:{for:"input-title"}},[t._v("Название")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.workData.title,expression:"workData.title"}],staticClass:"addWorks__input addWorks__input--title",class:{validError:t.validation.hasError("workData.title")},attrs:{type:"text",name:"title",id:"input-title"},domProps:{value:t.workData.title},on:{input:function(a){a.target.composing||t.$set(t.workData,"title",a.target.value)}}}),t.validation.firstError("workData.title")?e("div",{staticClass:"error-input"},[t._v(t._s(t.validation.firstError("workData.title")))]):t._e()]),e("div",{staticClass:"addWorks__label-wrap"},[e("label",{staticClass:"addWorks__label",attrs:{for:"input-link"}},[t._v("Ссылка")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.workData.link,expression:"workData.link"}],staticClass:"addWorks__input addWorks__input--link",class:{validError:t.validation.hasError("workData.link")},attrs:{type:"text",name:"link",id:"input-link"},domProps:{value:t.workData.link},on:{input:function(a){a.target.composing||t.$set(t.workData,"link",a.target.value)}}}),t.validation.firstError("workData.link")?e("div",{staticClass:"error-input"},[t._v(t._s(t.validation.firstError("workData.link")))]):t._e()]),e("div",{staticClass:"addWorks__label-wrap"},[e("label",{staticClass:"addWorks__label",attrs:{for:"input-desc"}},[t._v("Описание")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.workData.description,expression:"workData.description"}],staticClass:"addWorks__input addWorks__input--desc",class:{validErrorTextarea:t.validation.hasError("workData.description")},attrs:{name:"desc",id:"input-desc"},domProps:{value:t.workData.description},on:{input:function(a){a.target.composing||t.$set(t.workData,"description",a.target.value)}}}),t.validation.firstError("workData.description")?e("div",{staticClass:"error-input"},[t._v(t._s(t.validation.firstError("workData.description")))]):t._e()]),e("div",{staticClass:"addWorks__label-wrap"},[e("label",{staticClass:"addWorks__label",attrs:{for:"input-tag"}},[t._v("Добавление тега")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.workData.techs,expression:"workData.techs"}],staticClass:"addWorks__input addWorks__input--tags",class:{validError:t.validation.hasError("workData.techs")},attrs:{type:"text",name:"tag",id:"input-tag"},domProps:{value:t.workData.techs},on:{input:function(a){a.target.composing||t.$set(t.workData,"techs",a.target.value)}}}),t.validation.firstError("workData.techs")?e("div",{staticClass:"error-input"},[t._v(t._s(t.validation.firstError("workData.techs")))]):t._e()]),e("div",{staticClass:"addWorks__tags-list-wrap"},[e("ul",{staticClass:"addWorks__tags-list"},t._l(t.tagsArray,(function(a,r){return 0!=t.tagsArray&&""!=a?e("li",{staticClass:"addWorks__tags-item"},[t._v(t._s(a)),e("div",{staticClass:"deleteTag",on:{click:function(a){return t.removeTag(r)}}},[t._v("x")])]):t._e()})),0)]),e("div",{staticClass:"addWorks__buttons"},[e("button",{staticClass:"addWorks__reset",attrs:{type:"reset",name:"cancel",value:"Отменить"},on:{click:t.toogleAddingForm}},[t._v("Отменить")]),"add"==t.mode?e("button",{staticClass:"btn btn-save",attrs:{type:"submit",name:"submit",value:"Сохранить"},on:{click:t.addNewWorks}},[t._v("Сохранить")]):t._e(),"edit"==t.mode?e("button",{staticClass:"btn btn-save",attrs:{type:"submit",name:"submit",value:"Сохранить"},on:{click:t.updateCurrentWork}},[t._v("Сохранить")]):t._e()])])])])])};r._withStripped=!0;var o=e(94),s=e(414),i=e(324),n=e(441),d=e.n(n);function l(t,a){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),e.push.apply(e,r)}return e}function c(t){for(var a=1;a<arguments.length;a++){var e=null!=arguments[a]?arguments[a]:{};a%2?l(Object(e),!0).forEach((function(a){u(t,a,e[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):l(Object(e)).forEach((function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(e,a))}))}return t}function u(t,a,e){return a in t?Object.defineProperty(t,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[a]=e,t}var p={mixins:[e(324).mixin],validators:{"workData.title":function(t){return i.Validator.value(t).required("Поле название обязательно для заполнения")},"workData.link":function(t){return i.Validator.value(t).required("Поле ссылка обязательно для заполнения")},"workData.description":function(t){return i.Validator.value(t).required("Поле описание обязательно для заполнения")},"workData.techs":function(t){return i.Validator.value(t).required("Поле теги обязательно для заполнения")},"workData.photo":function(t){return i.Validator.value(t).required("Вставьте файл")}},components:{vueDropzone:d.a},props:{mode:String},data:function(){return{workData:{title:"",link:"",description:"",techs:"",photo:""},photoURl:"",hasImage:!1,tagsArray:[],dropOptions:{url:"https://httpbin.org/post",maxFilesize:1.5,maxFiles:1,chunking:!1,addRemoveLinks:!1}}},methods:c({},Object(o.b)("works",["addWork","updateWork"]),{},Object(o.b)("tooltips",["showTooltip","hideTooltip"]),{toogleAddingForm:function(){this.$emit("toogleAddingForm")},removeTag:function(t){console.log(t),this.tagsArray.splice(t,1),this.workData.techs=this.tagsArray.join(",")},loadPhoto:function(t){var a=this,e=t.target.files[0];this.workData.photo=e,this.hasImage=!0;var r=new FileReader;try{r.readAsDataURL(e),r.onload=function(){a.photoURl=r.result,console.log(a.photoURl)}}catch(t){alert(t.message),console.log(t.message)}},addNewWorks:function(){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.$validate());case 2:if(t.t0=t.sent,!1!==t.t0){t.next=6;break}return this.showTooltip({type:"error",text:"Не все поля заполнены"}),t.abrupt("return");case 6:return t.prev=6,t.next=9,regeneratorRuntime.awrap(this.addWork(this.workData));case 9:this.showTooltip({type:"success",text:"Работа успешно добавлена"}),this.$emit("toogleAddingForm"),t.next=16;break;case 13:t.prev=13,t.t1=t.catch(6),this.showTooltip({type:"error",text:"Размер картинки больше 1,5 МБ"});case 16:case"end":return t.stop()}}),null,this,[[6,13]])},updateCurrentWork:function(){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.$validate());case 2:if(t.t0=t.sent,!1!==t.t0){t.next=7;break}return this.showTooltip({type:"error",text:"Не все поля заполнены"}),this.workData=c({},this.currentWork),t.abrupt("return");case 7:return t.prev=7,t.next=10,regeneratorRuntime.awrap(this.updateWork(this.workData));case 10:this.showTooltip({type:"success",text:"Работа успешно обновлена"}),this.$emit("toogleAddingForm"),t.next=17;break;case 14:t.prev=14,t.t1=t.catch(7),this.showTooltip({type:"error",text:"Размер картинки больше 1,5 МБ"});case 17:case"end":return t.stop()}}),null,this,[[7,14]])},addingMode:function(){this.workData={title:"",link:"",description:"",techs:"",photo:""},this.photoURl=""},editingMode:function(){this.workData=c({},this.currentWork),this.photoURl=Object(s.a)(this.workData.photo)}}),watch:{"workData.techs":function(){this.tagsArray=this.workData.techs.split(",")},mode:function(){"add"==this.mode?(console.log("Режим добавления"),this.addingMode()):"edit"==this.mode&&(console.log("Режим редактирования"),this.editingMode())},currentWork:function(){this.workData=c({},this.currentWork),this.photoURl=Object(s.a)(this.workData.photo)}},computed:c({},Object(o.c)("works",{currentWork:function(t){return t.currentWork}})),created:function(){"add"==this.mode?this.addingMode():"edit"==this.mode&&this.editingMode()}},k=(e(442),e(95)),h=Object(k.a)(p,r,[],!1,null,"3aaed66e",null);h.options.__file="src/admin/components/works-add-new.vue";a.default=h.exports}}]);